---
import Layout from '../../layouts/Layout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('blog')).sort(
	(a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout title="Blog | Sion Jaison">
  
  <nav class="fixed top-0 left-0 right-0 z-40 flex justify-center pt-6 reveal">
    <div class="bg-white/80 dark:bg-[#1c1c1c]/80 backdrop-blur-md border border-gray-200 dark:border-[#2a2a2a] px-6 py-3 rounded-full flex gap-6 items-center shadow-lg transition-colors duration-300">
      <a href="/" class="text-gray-500 dark:text-gray-400 font-medium hover:text-black dark:hover:text-white transition text-sm tracking-wide">HOME</a>
      <a href="/blog" class="text-gray-900 dark:text-white font-bold hover:text-indigo-500 transition text-sm tracking-wide">BLOG</a>
      <a href="/about" class="text-gray-500 dark:text-gray-400 font-medium hover:text-black dark:hover:text-white transition text-sm tracking-wide">ALL</a>
      
      <button id="themeToggle" class="ml-2 w-8 h-8 rounded-full bg-gray-100 dark:bg-[#333] flex items-center justify-center text-gray-600 dark:text-yellow-400 hover:scale-110 transition">
        <svg class="w-4 h-4 block dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
        <svg class="w-4 h-4 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path></svg>
      </button>
    </div>
  </nav>

  <main class="max-w-[1000px] mx-auto px-6 py-32">
    
    <div class="text-center mb-20 reveal">
        <h1 class="text-5xl font-bold text-gray-900 dark:text-white mb-6">Thoughts & <span class="text-indigo-500">Updates</span></h1>
        <p class="text-gray-600 dark:text-gray-400 text-lg max-w-2xl mx-auto">
            Deep dives into network security, automation workflows with n8n, and Linux server troubleshooting.
        </p>
    </div>

    <div class="grid md:grid-cols-2 gap-8">
        {posts.map((post) => (
            <a href={`/blog/${post.slug}/`} class="spotlight-card reveal group relative bg-white dark:bg-[#1c1c1c] border border-gray-200 dark:border-[#2a2a2a] rounded-[2rem] overflow-hidden hover:border-indigo-500 dark:hover:border-indigo-500 transition duration-300">
                
                <div class="aspect-video w-full overflow-hidden bg-gray-100 dark:bg-[#252525]">
                    {post.data.heroImage ? (
                        <img src={post.data.heroImage} alt="" class="w-full h-full object-cover group-hover:scale-105 transition duration-700" />
                    ) : (
                        <div class="w-full h-full flex items-center justify-center text-gray-300 dark:text-[#333] text-6xl font-bold">üìù</div>
                    )}
                </div>

                <div class="p-8">
                    <div class="flex items-center gap-3 mb-4 text-xs font-mono text-gray-500 dark:text-gray-400 uppercase tracking-widest">
                        <span>{post.data.pubDate.toLocaleDateString()}</span>
                        <span class="w-1 h-1 bg-indigo-500 rounded-full"></span>
                        <span>Blog</span>
                    </div>
                    <h3 class="text-2xl font-bold text-gray-900 dark:text-white mb-3 group-hover:text-indigo-500 transition leading-tight">
                        {post.data.title}
                    </h3>
                    <p class="text-gray-600 dark:text-gray-400 text-sm leading-relaxed line-clamp-2">
                        {post.data.description}
                    </p>
                </div>
            </a>
        ))}
    </div>

  </main>

  <script is:inline>
    // Theme Logic
    const handleToggleClick = () => {
      const element = document.documentElement;
      element.classList.toggle("dark");
      localStorage.setItem("theme", element.classList.contains("dark") ? "dark" : "light");
    }
    document.getElementById("themeToggle").addEventListener("click", handleToggleClick);

    // Spotlight Logic
    const cards = document.querySelectorAll('.spotlight-card');
    document.addEventListener('mousemove', (e) => {
      for (const card of cards) {
        const rect = card.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;
        card.style.setProperty('--mouse-x', `${x}px`);
        card.style.setProperty('--mouse-y', `${y}px`);
      }
    });
  </script>

  <style>
    .spotlight-card { position: relative; }
    :global(.dark) .spotlight-card::before {
      content: ""; position: absolute; top: 0; left: 0; right: 0; bottom: 0; border-radius: 2rem;
      background: radial-gradient(800px circle at var(--mouse-x) var(--mouse-y), rgba(255, 255, 255, 0.06), transparent 40%);
      opacity: 0; transition: opacity 0.5s; pointer-events: none; z-index: 2;
    }
    :global(.dark) .spotlight-card:hover::before { opacity: 1; }
  </style>

</Layout>
